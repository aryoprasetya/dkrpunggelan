<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Data Potensi Pramuka â€” Kwarran Punggelan</title>
  <link rel="icon" href="assets/images/logodkr.png" type="image/png">

  <!-- Font Quantico -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
  <!-- Boxicons -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

  <style>
    :root{
      --wosm-purple: #5b2c83;
      --wosm-purple-light: #6f3aa6;
      --bg: #faf9ff;
      --muted: #6b7280;
      --radius: 12px;
      --max-w: 1200px;
    }
    *{box-sizing:border-box;scroll-behavior:smooth}
    body{margin:0;font-family:'Montserrat',sans-serif;background:var(--bg);color:#111;line-height:1.5}

    header{position:sticky;top:0;z-index:1000;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .nav-container{max-width:var(--max-w);margin:auto;display:flex;align-items:center;justify-content:space-between;padding:12px 20px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:44px;width:44px;object-fit:contain}
    .brand h1{margin:0;font-size:18px;color:var(--wosm-purple)}
    main{max-width:var(--max-w);margin:22px auto;padding:0 18px}
    h2{color:var(--wosm-purple);margin:0 0 10px}
    .card{background:#fff;padding:16px;border-radius:var(--radius);box-shadow:0 4px 16px rgba(0,0,0,.04);margin-bottom:18px}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .controls .control{display:flex;flex-direction:column;gap:6px}
    input[type="search"], select{padding:8px 10px;border-radius:8px;border:1px solid #e6e6ee;min-width:180px}
    .btn{display:inline-block;padding:9px 12px;border-radius:8px;background:var(--wosm-purple);color:#fff;text-decoration:none;cursor:pointer;border:none}
    .stats{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .stat{background:linear-gradient(180deg,var(--wosm-purple),var(--wosm-purple-light));color:#fff;padding:10px;border-radius:10px;min-width:160px;text-align:center}
    table{width:100%;border-collapse:collapse;margin-top:12px;font-family:inherit}
    th,td{padding:10px;border-bottom:1px solid #f0edf5;text-align:left;font-size:14px}
    th{background:#fff;position:sticky;top:0;color:var(--wosm-purple);z-index:1}
    .tag{display:inline-block;padding:4px 8px;border-radius:999px;background:rgba(91,44,131,.08);color:var(--wosm-purple);font-weight:700;font-size:12px}
    .small-muted{color:var(--muted);font-size:13px}
    .empty{padding:18px;text-align:center;color:var(--muted)}
    /* Responsive */
    @media(max-width:900px){
      .controls{flex-direction:column;align-items:stretch}
      .stats{flex-direction:column}
      th,td{font-size:13px}
    }

    /* Header */
    header{position:sticky;top:0;z-index:1000;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .nav-container{max-width:var(--max-w);margin:auto;display:flex;align-items:center;justify-content:space-between;padding:12px 20px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:50px;width:50px;object-fit:contain}
    .brand h1{margin:0;font-size:20px;color:var(--wosm-purple)}
    nav{display:flex;align-items:center;gap:20px}
    nav a{color:#333;text-decoration:none;padding:8px 0;font-weight:600;position:relative}
    nav a::after{content:"";position:absolute;left:0;bottom:0;width:0;height:2px;background:var(--wosm-purple);transition:.3s}
    nav a:hover::after{width:100%}
    nav a:hover{color:var(--wosm-purple)}
    .dropdown{position:relative}
    .dropdown-menu{display:none;position:absolute;top:100%;left:0;background:#fff;box-shadow:0 4px 20px rgba(0,0,0,.08);border-radius:8px;min-width:220px;padding:10px}
    .dropdown-menu a{display:block;padding:8px;border-radius:6px;color:#333}
    .dropdown:hover .dropdown-menu{display:block}

    /* Burger Menu */
    .menu-toggle{display:none;font-size:26px;color:var(--wosm-purple);cursor:pointer}
    @media (max-width: 768px) {

  nav {
    display: flex; /* JANGAN none */
    flex-direction: column;
    align-items: flex-start;
    text-align: left;

    position: absolute;
    top: 70px;
    left: 12px;
    right: 12px;

    background: #fff;
    padding: 14px;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,.15);
    z-index: 2000;

    /* ðŸ”´ AWAL TERSEMBUNYI */
    opacity: 0;
    transform: translateY(-12px);
    pointer-events: none;

    transition:
      opacity 0.25s ease,
      transform 0.25s ease;
  }

  nav.show {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  nav > a,
  nav .dropdown > a {
    width: 100%;
    padding: 10px 8px;
    text-align: left;
    justify-content: space-between;
  }

  .menu-toggle {
    display: block;
  }

  .dropdown {
    width: 100%;
  }

  .dropdown-menu {
    position: static;
    display: none;
    width: 100%;
    margin-top: 6px;
    padding-left: 12px;
    background: transparent;
    box-shadow: none;
  }

  .dropdown.open .dropdown-menu {
    display: block;
  }
}

    /* Footer */
    footer{background:var(--wosm-purple);color:#fff;margin-top:40px;padding:40px 20px 20px;font-size:14px}
    footer h4{margin:0 0 10px;font-size:14px;font-weight:700;text-transform:uppercase}
    footer p{margin:0 0 10px;line-height:1.6}
    footer a{color:#fff;text-decoration:none}
    footer a:hover{text-decoration:underline}
    .footer-grid{max-width:1200px;margin:auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px}
    .socials{display:flex;gap:10px;margin-top:10px}
    .socials a{display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:4px;background:rgba(255,255,255,.15);font-size:18px;transition:.3s}
    .socials a:hover{background:#fff;color:var(--wosm-purple)}
    footer hr{border:none;border-top:1px solid rgba(255,255,255,.2);margin:20px 0}
    .credits{text-align:center;font-size:13px;color:rgba(255,255,255,.8)}

    .btn-purple {
  background: var(--wosm-purple);
  color: #fff !important;
  padding: 8px 14px;
  border-radius: 8px;
  font-weight: 600;
  text-decoration: none;
  transition: 0.3s;
}
.btn-purple:hover {
  background: var(--wosm-purple-light);
}
  </style>

  <!-- Accessibility Button -->
<div id="accessibility-btn">
  <i class='bx bx-universal-access'></i>
</div>

<!-- Accessibility Panel -->
<div id="accessibility-panel">
  <h4>Accessibility Tools</h4>
  <button onclick="changeFontSize(1)"><i class='bx bx-zoom-in'></i> Increase Text</button>
  <button onclick="changeFontSize(-1)"><i class='bx bx-zoom-out'></i> Decrease Text</button>
  <button onclick="toggleClass('grayscale')"><i class='bx bx-droplet'></i> Grayscale</button>
  <button onclick="toggleClass('high-contrast')"><i class='bx bx-adjust'></i> High Contrast</button>
  <button onclick="toggleClass('negative-contrast')"><i class='bx bx-moon'></i> Negative Contrast</button>
  <button onclick="toggleClass('light-bg')"><i class='bx bx-sun'></i> Light Background</button>
  <button onclick="toggleClass('underline-links')"><i class='bx bx-link'></i> Links Underline</button>
  <button onclick="toggleClass('readable-font')"><i class='bx bx-font'></i> Readable Font</button>
  <button onclick="resetAccessibility()"><i class='bx bx-reset'></i> Reset</button>
</div>

<style>
  #accessibility-btn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--wosm-purple);
    color: #fff;
    border-radius: 50%;
    width: 52px;
    height: 52px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 26px;
    cursor: pointer;
    z-index: 3000;
    box-shadow: 0 4px 12px rgba(0,0,0,.2);
    transition: .3s;
  }
  #accessibility-btn:hover {
    background: var(--wosm-purple-light);
  }
  #accessibility-panel {
    position: fixed;
    bottom: 80px;
    right: 20px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0,0,0,.2);
    padding: 16px;
    width: 260px;
    display: none;
    flex-direction: column;
    gap: 8px;
    z-index: 3000;
  }
  #accessibility-panel h4 {
    margin: 0 0 10px;
    font-size: 16px;
    color: var(--wosm-purple);
  }
  #accessibility-panel button {
    display: flex;
    align-items: center;
    gap: 8px;
    background: #f4f4f4;
    border: none;
    padding: 8px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    transition: .3s;
  }
  #accessibility-panel button:hover {
    background: var(--wosm-purple);
    color: #fff;
  }

  /* Effects */
  body.grayscale { filter: grayscale(100%) !important; }
  body.high-contrast { background: #000 !important; color: #fff !important; }
  body.negative-contrast { background: #000 !important; color: yellow !important; }
  body.light-bg { background: #fff !important; color: #000 !important; }
  body.underline-links a { text-decoration: underline !important; }
  body.readable-font { font-family: 'OpenDyslexic', Arial, sans-serif !important; }
</style>

<!-- Font untuk Readable -->
<link href="https://fonts.cdnfonts.com/css/open-dyslexic" rel="stylesheet">

<script>
  // Toggle Panel
  document.getElementById("accessibility-btn").addEventListener("click", () => {
    const panel = document.getElementById("accessibility-panel");
    panel.style.display = panel.style.display === "flex" ? "none" : "flex";
  });

  // Font Size
  let fontSize = 100;
  function changeFontSize(change) {
    fontSize += change * 10;
    document.body.style.fontSize = fontSize + "%";
  }

  // Toggle Class
  function toggleClass(cls) {
    document.body.classList.toggle(cls);
  }

  // Reset
  function resetAccessibility() {
    fontSize = 100;
    document.body.style.fontSize = "100%";
    document.body.className = "";
  }
</script>

</head>
<body>
  <header>
    <div class="nav-container">
      <div class="brand">
        <img src="assets/images/logodkr.png" alt="Logo DKR">
        <h1>DKR Punggelan</h1>
      </div>
      <div class="menu-toggle" onclick="toggleMenu()"><i class='bx bx-menu'></i></div>
      <nav id="nav">
        <a href="index.html">Beranda</a>
        <div class="dropdown">
          <a href="javascript:void(0)" onclick="toggleDropdown(this)">Profil <i class='bx bx-chevron-down'></i></a>
          <div class="dropdown-menu">
            <a href="about.html">Tentang DKR Punggelan</a>
            <a href="profil.html">Profil Anggota DKR</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="javascript:void(0)" onclick="toggleDropdown(this)">Organisasi <i class='bx bx-chevron-down'></i></a>
          <div class="dropdown-menu">
            <a href="unduh.html">Media Unduh</a>
            <a href="potensi.html">Data Potensi Pramuka Kwarran</a>
          </div>
        </div>
        <a href="https://dkrpunggelan.wordpress.com/">Berita</a>
        <a href="login.html" class="btn-purple">LOGIN</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="card" id="data">
      <h2>Data Potensi Pramuka Kwarran Punggelan</h2>

      <div class="controls" style="margin-top:12px">
        <div class="control">
          <label for="q">Cari sekolah</label>
          <input id="q" type="search" placeholder="ketik nama sekolah (mis. SD Negeri 1 Punggelan)" oninput="applyFilters()">
        </div>

        <div class="control">
          <label for="level">Level Sekolah</label>
          <select id="level" onchange="applyFilters()">
            <option value="all">Semua (SD/MI, SMP/MTS, SMK)</option>
            <option value="sd">SD / MI</option>
            <option value="smp">SMP / MTS</option>
            <option value="smk">SMK</option>
          </select>
        </div>

        <div class="control">
          <label for="gender">Jenis Kelamin</label>
          <select id="gender" onchange="applyFilters()">
            <option value="all">Semua</option>
            <option value="putra">Putra</option>
            <option value="putri">Putri</option>
          </select>
        </div>

        <div class="control">
          <label for="branch">Golongan</label>
          <select id="branch" onchange="applyFilters()">
            <option value="all">Semua</option>
            <option value="siaga">Siaga</option>
            <option value="penggalang">Penggalang</option>
            <option value="penegak">Penegak</option>
            <option value="pandega">Pandega</option>
          </select>
        </div>

        <div style="margin-left:auto;display:flex;gap:8px;align-items:end">
          <button class="btn" onclick="resetFilters()">Reset</button>
          <button class="btn" onclick="exportCSV()" title="Unduh CSV">Export CSV</button>
        </div>
      </div>

      <div class="stats">
        <div class="stat" id="total-schools">Sekolah: â€”</div>
        <div class="stat" id="total-members">Total Anggota: â€”</div>
        <div class="stat" id="total-putra">Putra: â€”</div>
        <div class="stat" id="total-putri">Putri: â€”</div>
      </div>

      <div style="overflow:auto;margin-top:12px">
        <table id="schools-table" aria-describedby="table-desc">
          <thead>
            <tr>
              <th style="min-width:220px">Sekolah / Gugus Depan</th>
              <th style="min-width:110px">Level</th>
              <th style="min-width:100px">Total</th>
              <th style="min-width:90px">Putra</th>
              <th style="min-width:90px">Putri</th>
              <th style="min-width:160px">Pembagian (S/P/Pe/Pa)</th>
              <th style="min-width:140px">Kontak / Alamat (singkat)</th>
            </tr>
          </thead>
          <tbody id="table-body"></tbody>
        </table>
      </div>

      <div id="no-result" class="empty" style="display:none">Tidak ada sekolah yang cocok dengan filter.</div>
    </section>

    <section class="card" id="sumber" style="margin-top:8px">
  <h3>Sumber Data & Catatan</h3>
  <ul>
    <li><strong>Perhatian:</strong> Jika terdapat kesalahan data, atau ada sekolah/gugus depan pramuka yang belum tercantum, harap segera hubungi <strong>admin, humas, atau DKR Punggelan</strong>.</li>
  </ul>
</section>
  </main>

  <footer>
  <div class="footer-grid" style="gap:40px">
    <div>
      <h4>DKR PUNGGELAN</h4>
      <p>Dewan Kerja Ranting Punggelan adalah wadah pengembangan kepemimpinan pramuka penegak dan pandega di Kecamatan Punggelan.</p>
      <p><em>"Mengabdi dengan Kreasi, Menginspirasi dengan Aksi"</em></p>
    </div>
    <div>
      <h4>SEKRETARIAT</h4>
      <p>Dindikpora Kec. Punggelan<br>Jl. Raya Pasar Manis, Banjarnegara, Jateng 53462</p>
      <p>Email: <a href="mailto:dewankerjarantingkecpunggelan@gmail.com">dewankerjarantingkecpunggelan@gmail.com</a></p>
    </div>
    <div>
      <h4>ORGANISASI</h4>
      <ul style="list-style:none;padding:0;margin:0;line-height:1.8">
        <li>
          <a href="https://pramukabanjarnegara.or.id" target="_blank">
            Kwarcab Banjarnegara <i class='bx bx-link-external'></i>
          </a>
        </li>
        <li>
          <a href="https://pramukajateng.or.id" target="_blank">
            Kwarda Jawa Tengah <i class='bx bx-link-external'></i>
          </a>
        </li>
        <li>
          <a href="https://pramuka.or.id" target="_blank">
            Kwartir Nasional <i class='bx bx-link-external'></i>
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h4>MEDIA SOSIAL</h4>
      <div class="socials">
        <a href="https://facebook.com/DkrPunggelan" target="_blank"><i class='bx bxl-facebook'></i></a>
        <a href="https://x.com/dkr__punggelan" target="_blank"><i class='bx bxl-twitter'></i></a>
        <a href="https://youtube.com" target="_blank"><i class='bx bxl-youtube'></i></a>
        <a href="https://instagram.com/dkr__punggelan" target="_blank"><i class='bx bxl-instagram'></i></a>
      </div>
    </div>
  </div>
  <hr>
  <div class="credits">Â© 2025 Dewan Kerja Ranting Punggelan. Semua Hak Dilindungi.</div>
</footer>

  <script>
    /****************************************************************
     * S T A T I C   D A T A  (contoh) -- GANTI sesuai kebutuhanmu
     * - Field level: "sd" | "smp" | "smk"
     * - each school has "gugus" = array of unit names
     * - counts: total, putra, putri, breakdown = {siaga,penggalang,penegak,pandega}
     ****************************************************************/
const schoolsData = [

/* ========================= SD ========================= */
{school:"SD Negeri 1 Sambong",level:"sd",gugus:["12-001","12-002"]},
{school:"SD Negeri 2 Sambong",level:"sd",gugus:["12-003","12-004"]},
{school:"SD Negeri 1 Danakerta",level:"sd",gugus:["12-005","12-006"]},
{school:"SD Negeri 2 Danakerta",level:"sd",gugus:["12-007","12-008"]},
{school:"SD Negeri 3 Danakerta",level:"sd",gugus:["12-009","12-010"]},
{school:"SD Negeri 4 Danakerta",level:"sd",gugus:["12-011","12-012"]},
{school:"SD Negeri Klapa",level:"sd",gugus:["12-013","12-014"]},
{school:"SD Negeri 1 Kecepit",level:"sd",gugus:["12-015","12-016"]},
{school:"SD Negeri 2 Kecepit",level:"sd",gugus:["12-017","12-018"]},
{school:"SD Negeri 1 Karangsari",level:"sd",gugus:["12-019","12-020"]},
{school:"SD Negeri 2 Karangsari",level:"sd",gugus:["12-021","12-022"]},
{school:"SD Negeri 4 Karangsari",level:"sd",gugus:["12-023","12-024"]},
{school:"SD Negeri 1 Tribuana",level:"sd",gugus:["12-025","12-026"]},
{school:"SD Negeri 2 Tribuana",level:"sd",gugus:["12-027","12-028"]},
{school:"SD Negeri 1 Sawangan",level:"sd",gugus:["12-029","12-030"]},
{school:"SD Negeri 2 Sawangan",level:"sd",gugus:["12-031","12-032"]},
{school:"SD Negeri 3 Sawangan",level:"sd",gugus:["12-033","12-034"]},
{school:"SD Negeri 1 Sidarata",level:"sd",gugus:["12-035","12-036"]},
{school:"SD Negeri 2 Sidarata",level:"sd",gugus:["12-037","12-038"]},
{school:"SD Negeri Badakarya",level:"sd",gugus:["12-039","12-040"]},
{school:"SD Negeri 1 Punggelan",level:"sd",gugus:["12-041","12-042"]},
{school:"SD Negeri 2 Punggelan",level:"sd",gugus:["12-043","12-044"]},
{school:"SD Negeri 4 Punggelan",level:"sd",gugus:["12-045","12-046","12-047","12-048"]},
{school:"SD Negeri 1 Jembangan",level:"sd",gugus:["12-049","12-050"]},
{school:"SD Negeri 2 Jembangan",level:"sd",gugus:["12-051","12-052"]},
{school:"SD Negeri 4 Jembangan",level:"sd",gugus:["12-053","12-054"]},
{school:"SD Negeri 1 Purwasana",level:"sd",gugus:["12-055","12-056"]},
{school:"SD Negeri 2 Purwasana",level:"sd",gugus:["12-057","12-058"]},
{school:"SD Negeri 3 Purwasana",level:"sd",gugus:["12-059","12-060"]},
{school:"SD Negeri 4 Purwasana",level:"sd",gugus:["12-061","12-062"]},
{school:"SD Negeri 1 Petuguran",level:"sd",gugus:["12-063","12-064"]},
{school:"SD Negeri 4 Petuguran",level:"sd",gugus:["12-065","12-066","12-067","12-068"]},
{school:"SD Negeri 1 Bondolharjo",level:"sd",gugus:["12-069","12-070"]},
{school:"SD Negeri 2 Bondolharjo",level:"sd",gugus:["12-071","12-072"]},
{school:"SD Negeri 3 Bondolharjo",level:"sd",gugus:["12-073","12-074"]},
{school:"SD Negeri 1 Tanjungtirta",level:"sd",gugus:["12-075","12-076"]},
{school:"SD Negeri 2 Tanjungtirta",level:"sd",gugus:["12-077","12-078"]},
{school:"SD Negeri 1 Tlaga",level:"sd",gugus:["12-079","12-080"]},
{school:"SD Negeri 3 Tlaga",level:"sd",gugus:["12-081","12-082"]},
{school:"SD Negeri 1 MlayA",level:"sd",gugus:["12-083","12-084"]},
{school:"SD Negeri 2 MlayA",level:"sd",gugus:["12-085","12-086"]},
{school:"SDIT Insan Mandiri",level:"sd",gugus:["12-147","12-148"]},

/* ========================= MI ========================= */
{school:"MIN Punggelan",level:"mi",gugus:["12-087","12-088"]},
{school:"MI Muhammadiyah 01 Sambong",level:"mi",gugus:["12-089","12-090"]},
{school:"MI Muhammadiyah 01 Danakerta",level:"mi",gugus:["12-091","12-092","12-093","12-094"]},
{school:"MI Muhammadiyah 02 Danakerta",level:"mi",gugus:["12-095","12-096"]},
{school:"MI Maâ€™arif Danakerta",level:"mi",gugus:["12-097","12-098"]},
{school:"MI Maâ€™arif Klapa",level:"mi",gugus:["12-099","12-100"]},
{school:"MI Muhammadiyah Kecepit",level:"mi",gugus:["12-101","12-102"]},
{school:"MI Muhammadiyah Karangsari",level:"mi",gugus:["12-103","12-104"]},
{school:"MI Cokroaminoto 02 Tribuana",level:"mi",gugus:["12-105","12-106","12-107","12-108"]},
{school:"MI Cokroaminoto 03 Tribuana",level:"mi",gugus:["12-109","12-110"]},
{school:"MI Cokroaminoto Sawangan",level:"mi",gugus:["12-111","12-112"]},
{school:"MI Cokroaminoto Sidarata",level:"mi",gugus:["12-113","12-114"]},
{school:"MI Muhammadiyah Badakarya",level:"mi",gugus:["12-115","12-116"]},
{school:"MI Cokroaminoto 1 Badakarya",level:"mi",gugus:["12-117","12-118"]},
{school:"MI Cokroaminoto 2 Badakarya",level:"mi",gugus:["12-119","12-120"]},
{school:"MI GUPPI 01 Jembangan",level:"mi",gugus:["12-121","12-122"]},
{school:"MI GUPPI 02 Jembangan",level:"mi",gugus:["12-123","12-124"]},
{school:"MI Cokroaminoto Purwasana",level:"mi",gugus:["12-125","12-126"]},
{school:"MI Cokroaminoto 01 Petuguran",level:"mi",gugus:["12-127","12-128"]},
{school:"MI Cokroaminoto 02 Petuguran",level:"mi",gugus:["12-129","12-130"]},
{school:"MI Al Hidayah Petuguran",level:"mi",gugus:["12-131","12-132"]},
{school:"MI Cokroaminoto 01 Bondolharjo",level:"mi",gugus:["12-133","12-134"]},
{school:"MI Cokroaminoto 02 Bondolharjo",level:"mi",gugus:["12-135","12-136"]},
{school:"MI Cokroaminoto 03 Bondolharjo",level:"mi",gugus:["12-137","12-138"]},
{school:"MI Cokroaminoto 04 Bondolharjo",level:"mi",gugus:["12-139","12-140"]},
{school:"MI Cokroaminoto Tanjungtirta",level:"mi",gugus:["12-141","12-142"]},
{school:"MI GUPPI 02 Tlaga",level:"mi",gugus:["12-143","12-144","12-145","12-146"]},

/* ========================= SMP ========================= */
{school:"SMP Negeri 1 Punggelan",level:"smp",gugus:["12-201","12-202"]},
{school:"SMP Negeri 2 Punggelan",level:"smp",gugus:["12-203","12-204"]},
{school:"SMP Negeri 3 Punggelan",level:"smp",gugus:["12-205","12-206"]},
{school:"SMP Negeri 4 Punggelan",level:"smp",gugus:["12-207","12-208"]},
{school:"SMP Negeri 5 Satap Punggelan",level:"smp",gugus:["12-215","12-216"]},
{school:"SMP Negeri 6 Satap Punggelan",level:"smp",gugus:["12-217","12-218"]},
{school:"SMP Cokroaminoto Punggelan",level:"smp",gugus:["12-219","12-220"]},

/* ========================= MTs ========================= */
{school:"MTs Muhammadiyah Kecepit",level:"mts",gugus:["12-209","12-210"]},
{school:"MTs Cokroaminoto Tribuana",level:"mts",gugus:["12-211","12-212"]},
{school:"MTs Cokroaminoto Tanjungtirta",level:"mts",gugus:["12-213","12-214"]},

/* ========================= SMK ========================= */
{school:"SMKN 1 Punggelan",level:"smk",gugus:["12-301","12-302"]}

];

    /****************************************************************
     * RENDERING + FILTERS
     ****************************************************************/
    const tableBody = document.getElementById('table-body');
    const totalSchoolsEl = document.getElementById('total-schools');
    const totalMembersEl = document.getElementById('total-members');
    const totalPutraEl = document.getElementById('total-putra');
    const totalPutriEl = document.getElementById('total-putri');
    const noResult = document.getElementById('no-result');

    function formatBreakdown(b){
      return `${b.siaga}/${b.penggalang}/${b.penegak}/${b.pandega}`;
    }

    function render(rows){
      tableBody.innerHTML = "";
      if(!rows.length){
        noResult.style.display = "block";
        return;
      } else noResult.style.display = "none";

      rows.forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>
            <strong>${escapeHtml(r.school)}</strong><br>
            <span class="small-muted">${r.gugus.join(", ")}</span>
          </td>
          <td>${r.level.toUpperCase()}</td>
          <td>${r.total}</td>
          <td>${r.putra}</td>
          <td>${r.putri}</td>
          <td><span class="tag">${formatBreakdown(r.breakdown)}</span></td>
          <td class="small-muted">${escapeHtml(r.contact)}</td>
        `;
        tableBody.appendChild(tr);
      });
    }

    function applyFilters(){
      const q = document.getElementById('q').value.trim().toLowerCase();
      const level = document.getElementById('level').value;
      const gender = document.getElementById('gender').value;
      const branch = document.getElementById('branch').value;

      let rows = schoolsData.filter(s=>{
        if(level !== 'all' && s.level !== level) return false;
        if(q){
          const hay = (s.school + " " + s.gugus.join(" ") + " " + s.contact).toLowerCase();
          if(!hay.includes(q)) return false;
        }
        return true;
      });

      // If filtering by gender, we adjust displayed counts (but original data kept)
      // For branch filter: show only schools with >0 in that branch
      if(gender !== 'all'){
        rows = rows.map(s=>{
          const copy = JSON.parse(JSON.stringify(s));
          if(gender === 'putra'){
            // if putra count exists, keep only putra numbers; heuristic distribute by branch proportion
            const ratio = s.putra / Math.max(s.total,1);
            copy.putri = 0;
            copy.putra = s.putra;
            copy.breakdown = {
              siaga: Math.round(s.breakdown.siaga * ratio),
              penggalang: Math.round(s.breakdown.penggalang * ratio),
              penegak: Math.round(s.breakdown.penegak * ratio),
              pandega: Math.round(s.breakdown.pandega * ratio)
            };
            copy.total = copy.putra;
          } else if(gender === 'putri'){
            const ratio = s.putri / Math.max(s.total,1);
            copy.putra = 0;
            copy.putri = s.putri;
            copy.breakdown = {
              siaga: Math.round(s.breakdown.siaga * ratio),
              penggalang: Math.round(s.breakdown.penggalang * ratio),
              penegak: Math.round(s.breakdown.penegak * ratio),
              pandega: Math.round(s.breakdown.pandega * ratio)
            };
            copy.total = copy.putri;
          }
          return copy;
        });
      }

      if(branch !== 'all'){
        rows = rows.filter(s => {
          // use original data to decide existence
          const val = s.breakdown[branch];
          return val && val > 0;
        }).map(s=>{
          const copy = JSON.parse(JSON.stringify(s));
          // show only the selected branch as total
          copy.total = s.breakdown[branch];
          copy.putra = Math.round(copy.total * (s.putra / Math.max(s.total,1)));
          copy.putri = copy.total - copy.putra;
          // breakdown becomes just the selected branch
          copy.breakdown = { siaga:0, penggalang:0, penegak:0, pandega:0 };
          copy.breakdown[branch] = s.breakdown[branch];
          return copy;
        });
      }

      // summary stats
      const totals = rows.reduce((acc, r) => {
        acc.schools += 1;
        acc.total += (r.total || 0);
        acc.putra += (r.putra || 0);
        acc.putri += (r.putri || 0);
        return acc;
      }, {schools:0,total:0,putra:0,putri:0});

      totalSchoolsEl.textContent = `Sekolah: ${totals.schools}`;
      totalMembersEl.textContent = `Total Anggota: ${totals.total}`;
      totalPutraEl.textContent = `Putra: ${totals.putra}`;
      totalPutriEl.textContent = `Putri: ${totals.putri}`;

      render(rows);
    }

    function resetFilters(){
      document.getElementById('q').value = "";
      document.getElementById('level').value = "all";
      document.getElementById('gender').value = "all";
      document.getElementById('branch').value = "all";
      applyFilters();
    }

    function escapeHtml(s){
      return (s+"").replace(/[&<>"']/g, m=>{
        return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m];
      });
    }

    // Export visible rows to CSV
    function exportCSV(){
      const rows = Array.from(document.querySelectorAll('#table-body tr'));
      if(!rows.length){ alert('Tidak ada data untuk diexport.'); return; }
      let csv = "Sekolah;Level;Total;Putra;Putri;Siaga;Penggalang;Penegak;Pandega;Kontak\n";
      rows.forEach(tr=>{
        const cols = tr.querySelectorAll('td');
        const school = cols[0].querySelector('strong').textContent;
        const level = cols[1].textContent;
        const total = cols[2].textContent;
        const putra = cols[3].textContent;
        const putri = cols[4].textContent;
        // breakdown tag text like "40/50/20/10"
        const breakdown = cols[5].querySelector('.tag').textContent.split('/');
        const contact = cols[6].textContent;
        csv += `${school};${level};${total};${putra};${putri};${breakdown[0]};${breakdown[1]};${breakdown[2]};${breakdown[3]};${contact}\n`;
      });
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'data-potensi-pramuka-punggelan.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // init
    resetFilters();
  </script>
  <script>
  const menuToggle = document.querySelector('.menu-toggle');
  const nav = document.getElementById('nav');

  // Toggle menu utama
  menuToggle.addEventListener('click', () => {
    nav.classList.toggle('show');
  });

  // Dropdown khusus mobile (klik, bukan hover)
  document.querySelectorAll('.dropdown > a').forEach(link => {
    link.addEventListener('click', function (e) {
      if (window.innerWidth <= 768) {
        e.preventDefault();
        this.parentElement.classList.toggle('open');
      }
    });
  });
</script>
</body>
</html>
